// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

unit
  EnvironmentVariables;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

interface

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

uses
  Classes;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

type
  TEnvironmentVariables = class
    public
      class function Get(Name: String; DefValue: String): String;
  end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

implementation

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

uses
  SysUtils,
  Windows;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class function TEnvironmentVariables.Get(Name: String; DefValue: String): String;
var
  Value: String; Length: Integer;
begin
  Length := GetEnvironmentVariable(PChar(Name), nil, 0);

  if not(Length > 0) then begin

    Result := DefValue; Exit;

  end;

  SetLength(Value, Length - 1);
  GetEnvironmentVariable(PChar(Name), PChar(Value), Length);

  Result := Value;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

end.
