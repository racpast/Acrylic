// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

unit
  Stopwatch;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

interface

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

type
  TStopwatch = class
    public
      class function  GetInstantValue: Double;
      class function  GetElapsedTime: Double;
    public
      class procedure Start;
      class procedure Stop;
  end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

implementation

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

uses
  Windows;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

var
  TStopwatch_Buffer: Double;
  TStopwatch_Counter: Int64;
  TStopwatch_Frequency: Int64;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class procedure TStopwatch.Start;
begin
  TStopwatch_Buffer := GetInstantValue;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class procedure TStopwatch.Stop;
begin
  TStopwatch_Buffer := GetInstantValue - TStopwatch_Buffer;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class function TStopwatch.GetElapsedTime: Double;
begin
  Result := TStopwatch_Buffer;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class function TStopwatch.GetInstantValue: Double;
begin
  QueryPerformanceCounter(TStopwatch_Counter); Result := TStopwatch_Counter / TStopwatch_Frequency;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

initialization
  QueryPerformanceFrequency(TStopwatch_Frequency);
end.