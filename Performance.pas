
// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

unit
  Performance;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

interface

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

type
  TPerformance = class
    public
      class function  GetInstantValue(): Double;
      class function  GetElapsedTime(): Double;
    public
      class procedure StartClock();
      class procedure StopClock();
  end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

implementation

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

uses
  Windows;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

var
  TPerformance_Buffer: Double;
  TPerformance_Counter: Int64;
  TPerformance_Frequency: Int64;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class procedure TPerformance.StartClock();
begin
  TPerformance_Buffer := GetInstantValue();
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class procedure TPerformance.StopClock();
begin
  TPerformance_Buffer := GetInstantValue() - TPerformance_Buffer;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class function TPerformance.GetElapsedTime(): Double;
begin
  Result := TPerformance_Buffer;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

class function TPerformance.GetInstantValue(): Double;
begin
  QueryPerformanceCounter(TPerformance_Counter); Result := TPerformance_Counter / TPerformance_Frequency;
end;

// --------------------------------------------------------------------------
//
// --------------------------------------------------------------------------

initialization
  QueryPerformanceFrequency(TPerformance_Frequency);
end.
